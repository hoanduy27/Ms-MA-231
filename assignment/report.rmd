---
title: "Assignment"
author: Group 7
date: Nov 18, 2023
output: 
    html_document:
        # latex_engine: xelatex
        toc: true
        toc_depth: 2
---

```{r setup, include=FALSE} 

knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
library(ggplot2)
library(FactoMineR)
library(readxl)
library(httpgd)
```

```{r}
df <- read.csv("wine.data")
colnames(df) <- c(
    "class",
    "Alcohol",
    "Malic.acid",
    "Ash",
    "Alcalinity.of.ash",
    "Magnesium",
    "Total.phenols",
    "Flavanoids",
    "Nonflavanoid.phenols",
    "Proanthocyanins",
    "Color.intensity",
    "Hue",
    "OD280/OD315.of.diluted.wines",
    "Proline"
)
```

# Quantity & Meaning

```{r}
variables <- colnames(df)
# Examine the elements, identify the measurement quantity and type of scale
for (variable in variables) {
  unique_values <- unique(df[[variable]])
  num_unique_values <- length(unique_values)
 ## Quantity and meaning
  if (is.numeric(df[[variable]])) {
    quantity <- "Measured Quantity"
    meaning <- "Numeric Value"
  } else if (is.character(df[[variable]])) {
    quantity <- "Measured Quantity"
    meaning <- "Categorical Value"
  } else {
    quantity <- "Unknown"
    meaning <- "Unknown"
  }
  
  ##Measurement quantity
  if (data_type %in% c("numeric", "integer", "double")) {
    measurement_quantity <- "Numerical"
  } else if (data_type %in% c("character", "factor")) {
    measurement_quantity <- "Categorical"
  } else {
    measurement_quantity <- "Unknown"
  }
  
  ##Scale type & Measurement type
  if (data_type %in% c("numeric", "integer", "double")) {
    scale_type <- ifelse(length(unique(df[[variable]])) > 10, "Continuous", "Discrete")
    measurement_type <- "Quantitative"
  } else if (data_type %in% c("character", "factor")) {
    scale_type <- "Qualitative"
    measurement_type <- "Qualitative"
  } else {
    scale_type <- "Unknown"
    measurement_type <- "Unknown"
  }
  
  print(paste("Variable:", variable))
  print(paste("Quantity:", quantity))
  print(paste("Meaning:", meaning))
  print(paste("Number of Unique Values:", num_unique_values))
  print(paste("Measurement Quantity:", measurement_quantity))
  print(paste("Scale Type:", scale_type))
  print(paste("Measurement Type:", measurement_type))
  print("------------------------------")
}
```

## Hypothesis Formulation:

### Hypothesis 1: 

#### Research Hypotheses:

* "There are significant differences in the mean alcohol content among the three types of wines."

#### Statistical Hypotheses:

* Null Hypothesis (H0): "The mean alcohol content across the three types of wines is equal."

* Alternative Hypothesis (H1): "The mean alcohol content differs significantly among the three types of wines."

### Hypothesis 2:

#### Research Hypotheses:

* Research Hypothesis: "There exists a significant relationship between the total phenol content and the color intensity of wines."

#### Statistical Hypotheses:

* Null Hypothesis (H0): "There is no significant correlation between the total phenol content and the color intensity of wines."

* Alternative Hypothesis (H1): "There is a significant correlation between the total phenol content and the color intensity of wines."

### Hypothesis 3:

#### Research Hypotheses:

* Research Hypothesis: "The mean levels of proanthocyanins differ across the three types of wines."

#### Statistical Hypotheses:

* Null Hypothesis (H0): "The mean levels of proanthocyanins are equal across the three types of wines."

* Alternative Hypothesis (H1): "At least one of the mean levels of proanthocyanins differs significantly among the three types of wines."

### Hypothesis 4:

#### Research Hypotheses:

* Research Hypothesis: "There is a significant difference in the mean levels of flavonoids between wines with low and high alcohol content."

#### Statistical Hypotheses:

* Null Hypothesis (H0): "The mean levels of flavonoids are the same between wines with low and high alcohol content."

* Alternative Hypothesis (H1): "There is a significant difference in the mean levels of flavonoids between wines with low and high alcohol content."

### Hypothesis 5:

#### Research Hypotheses:

* Research Hypothesis: "The ash content has a positive correlation with the alcalinity of ash in wines."

#### Statistical Hypotheses:

* Null Hypothesis (H0): "There is no correlation between the ash content and the alcalinity of ash in wines."

* Alternative Hypothesis (H1): "There is a positive correlation between the ash content and the alcalinity of ash in wines."

# Code của Hà

```{r, echo=FALSE, warning=FALSE}
# Packages
library(FactoMineR)
library(factoextra)
library(tidyverse)
library(corrplot)
library(dbplyr)
library(ggplot2)

# Import data
data <- read.csv("wine.data", 
                 header=FALSE, 
                 row.names=NULL)

# Setting up the data
colnames(data) <- c("Type","Alcohol", "Malic", "Ash", "Alcalinity", "Magnesium", "Phenols", "Flavanoids", "Nonflavanoids", "Proan", "Color", "Hue", "Dilution", "Proline")

data$Type <- as.factor(data$Type)

# Check for null values 
colSums(is.na(data))

# Research Hypotheses
# research_hypotheses <- c("Hypothesis 1: ...", "Hypothesis 2: ...")

# Statistical Hypotheses (example for t-test)
# Assuming 'variable1' and 'variable2' are the variables of interest
#statistical_hypotheses <- t.test(data$variable1, data$variable2)

# Multivariate Analysis Considerations
# Assuming 'data' is your dataset
correlation_matrix <- cor(data[-1])
corrplot(correlation_matrix)
# Calculate correlation matrix

# Principal Component Analysis (PCA)
res.pca <- PCA(data, scale.unit=T, quali.sup="Type", graph=F)

# Multiple Correspondence Analysis (MCA)
#mca_result <- MCA(data)

# Eigenvalues
res.pca$eig

# Contribution
dimdesc(res.pca)

# Cos2
library("corrplot")
corrplot(res.pca$var$cos2, is.corr=F)

# Individuals
plot(res.pca,
     choix = "ind",
     hab = "Type",
     invisible = c("var"),
     select = "cos2 0.6",
     unselect = 0.7)

# Variables
plot(res.pca,
     choix = c("var"),
     hab = "none",
     invisible = c("ind"),
     select = NULL,
     unselect = 0.7)

# Correspondence Analysis
res.ca <- CA(data, quali.sup="Type", graph=F)

plot(res.ca, 
     invisible="col",
     selectRow = "cos2 100",
     unselect = 1
     )

plot(res.ca, 
     invisible="row",
     selectCol = NULL,
     unselect = 1
     )

# Thử Multiple Factor Analysis (MFA)
gr1 = data[1]
gr2 = data.frame(data[7:10], data[13])
gr3 = data.frame(data[2], data[11])
gr4 = data.frame(data[12], data[14])
gr5 = data[6]
gr6 = data[3]
data.cat = data.frame(gr1, gr2, gr3, gr4, gr5, gr6)

res.mfa <- MFA(data.cat,
               group = c(1, 5, 2, 2, 1, 1),
               type = c("n", rep("c",5)),
               name.group = c("Group1", "Group2", "Group3", "Group4", "Group5","Group6"),
               num.group.sup = c(1),
               graph = F)
```